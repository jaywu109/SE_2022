File "/opt/conda/lib/python3.7/site-packages/torch/nn/functional.py", line 2347, in layer_norm: [RuntimeError] CUDA out of memory. Tried to allocate 18.00 MiB (GPU 1; 31.75 GiB total capacity; 21.97 GiB already allocated; 10.69 MiB free; 22.27 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF